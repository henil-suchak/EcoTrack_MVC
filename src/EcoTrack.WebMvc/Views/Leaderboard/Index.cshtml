@using EcoTrack.WebMvc.ViewModels
@model LeaderboardPageViewModel

@{
    ViewData["Title"] = $"{Model.ActivePeriod} Leaderboard";
    var currentUserId = ViewBag.CurrentUserId != null ? Guid.Parse(ViewBag.CurrentUserId) : Guid.Empty;
}

<div class="text-center">
    <h1 class="display-4">üèÜ @Model.ActivePeriod Leaderboard</h1>
    <p class="lead">See who's making the biggest impact!</p>

    <div class="btn-group my-3" role="group">
        <a asp-action="Index" asp-route-period="Monthly" 
           class="btn @(Model.ActivePeriod == "Monthly" ? "btn-primary" : "btn-outline-primary")">
           Monthly
        </a>
        <a asp-action="Index" asp-route-period="Weekly" 
           class="btn @(Model.ActivePeriod == "Weekly" ? "btn-primary" : "btn-outline-primary")">
           Weekly
        </a>
    </div>
</div>

<div class="row justify-content-center mt-4">
    <div class="col-lg-8">
        <div class="card">
            <div class="card-body">
                @if (Model.Entries.Any())
                {
                    <table class="table table-striped table-hover">
                        <thead class="table-dark">
                            <tr>
                                <th scope="col">Rank</th>
                                <th scope="col">User</th>
                                <th scope="col">Total CO‚ÇÇ Emission</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var entry in Model.Entries)
                            {
                                var rowClass = entry.UserId == currentUserId ? "table-primary" : "";
                                <tr class="@rowClass">
                                    <th scope="row">@entry.Rank</th>
                                    <td>@entry.UserName</td>
                                    <td>@entry.CarbonEmission.ToString("F2") kg</td>
                                </tr>
                            }
                        </tbody>
                    </table>
                }
                else
                {
                    <p class="text-center">The @Model.ActivePeriod.ToLower() leaderboard is still being calculated. Check back soon!</p>
                }
            </div>
        </div>
    </div>
</div>