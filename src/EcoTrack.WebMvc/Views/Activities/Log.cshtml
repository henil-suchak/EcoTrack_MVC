@model EcoTrack.WebMvc.ViewModels.LogActivityViewModel
@using EcoTrack.WebMvc.Enums

@{
    ViewData["Title"] = "Log New Activity";
}

<div class="container py-4">
    <div class="row justify-content-center">
        <div class="col-lg-7">
            <div class="card shadow border-0 rounded-3">
                <div class="card-header fw-bold fs-5">
                    üìù Log New Activity
                </div>
                <div class="card-body">
                    <form asp-action="Log">
                        <div asp-validation-summary="All" class="text-danger mb-3"></div>

                        <!-- Activity Type -->
                        <div class="mb-3">
                            <label asp-for="ActivityType" class="form-label fw-semibold">Activity Type</label>
                            <select id="activityTypeSelector" 
                                    asp-for="ActivityType" 
                                    asp-items="Html.GetEnumSelectList<ActivityType>()" 
                                    class="form-select">
                                <option value="">-- Select an Activity Type --</option>
                            </select>
                            <span asp-validation-for="ActivityType" class="text-danger"></span>
                        </div>

                        <!-- Travel -->
                        <div id="travel-section" class="activity-details card p-3 mb-3" style="display: none;">
                            <h6 class="fw-bold text-primary">üö≤ Travel Details</h6>
                            <div class="mb-3">
                                <label asp-for="TravelMode" class="form-label"></label>
                                <input asp-for="TravelMode" class="form-control form-control-sm" />
                                <span asp-validation-for="TravelMode" class="text-danger"></span>
                            </div>
                            <div class="mb-3">
                                <label asp-for="Distance" class="form-label"></label>
                                <input asp-for="Distance" class="form-control form-control-sm" />
                                <span asp-validation-for="Distance" class="text-danger"></span>
                            </div>
                        </div>

                        <!-- Food -->
                        <div id="food-section" class="activity-details card p-3 mb-3" style="display: none;">
                            <h6 class="fw-bold text-success">ü•ó Food Details</h6>
                            <div class="mb-3">
                                <label asp-for="FoodType" class="form-label"></label>
                                <input asp-for="FoodType" class="form-control form-control-sm" />
                                <span asp-validation-for="FoodType" class="text-danger"></span>
                            </div>
                            <div class="mb-3">
                                <label asp-for="Quantity" class="form-label"></label>
                                <input asp-for="Quantity" class="form-control form-control-sm" />
                                <span asp-validation-for="Quantity" class="text-danger"></span>
                            </div>
                        </div>

                        <!-- Electricity -->
                        <div id="electricity-section" class="activity-details card p-3 mb-3" style="display: none;">
                            <h6 class="fw-bold text-warning">‚ö° Electricity Details</h6>
                            <div class="mb-3">
                                <label asp-for="ElectricityConsumption" class="form-label"></label>
                                <input asp-for="ElectricityConsumption" class="form-control form-control-sm" />
                                <span asp-validation-for="ElectricityConsumption" class="text-danger"></span>
                            </div>
                        </div>

                        <!-- Appliance -->
                        <div id="appliance-section" class="activity-details card p-3 mb-3" style="display: none;">
                            <h6 class="fw-bold text-info">üîå Appliance Details</h6>
                            <div class="mb-3">
                                <label asp-for="ApplianceType" class="form-label"></label>
                                <input asp-for="ApplianceType" class="form-control form-control-sm" />
                                <span asp-validation-for="ApplianceType" class="text-danger"></span>
                            </div>
                            <div class="mb-3">
                                <label asp-for="UsageTime" class="form-label"></label>
                                <input asp-for="UsageTime" class="form-control form-control-sm" />
                                <span asp-validation-for="UsageTime" class="text-danger"></span>
                            </div>
                            <div class="mb-3">
                                <label asp-for="PowerRating" class="form-label"></label>
                                <input asp-for="PowerRating" class="form-control form-control-sm" />
                                <span asp-validation-for="PowerRating" class="text-danger"></span>
                            </div>
                        </div>

                        <!-- Waste -->
                        <div id="waste-section" class="activity-details card p-3 mb-3" style="display: none;">
                            <h6 class="fw-bold text-danger">üóë Waste Details</h6>
                            <div class="mb-3">
                                <label asp-for="WasteType" class="form-label"></label>
                                <input asp-for="WasteType" class="form-control form-control-sm" />
                                <span asp-validation-for="WasteType" class="text-danger"></span>
                            </div>
                            <div class="mb-3">
                                <label asp-for="Amount" class="form-label"></label>
                                <input asp-for="Amount" class="form-control form-control-sm" />
                                <span asp-validation-for="Amount" class="text-danger"></span>
                            </div>
                        </div>

                       <!-- Submit -->
<div class="mt-4">
    <button type="submit" class="btn btn-custom w-100">Log Activity</button>
</div>

                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
<style>
    /* Custom button */
    .btn-custom {
        background-color: #2a9d8f ;
        border-color: #2a9d8f;
        color: #fff ;
        font-weight: 600;
    }
    .btn-custom:hover {
        background-color: #21867a ; /* slightly darker on hover */
        border-color: #21867a ;
    }

 
    #travel-section h6,
    #food-section h6,
    #electricity-section h6,
    #appliance-section h6,
    #waste-section h6 {
       
        color: #2a9d8f;
        padding: 6px 12px;
        border-radius: 6px;
        font-size: 0.95rem;
        margin-bottom: 12px;
    }
</style>


@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const selector = document.getElementById('activityTypeSelector');
            const allSections = document.querySelectorAll('.activity-details');

            function toggleSections() {
                const selectedValue = selector.value;

                allSections.forEach(section => {
                    section.style.display = 'none';
                    section.querySelectorAll('input, select').forEach(input => input.disabled = true);
                });

                let targetSection = null;
                if (selectedValue === "@((int)ActivityType.Travel)") {
                    targetSection = document.getElementById('travel-section');
                } else if (selectedValue === "@((int)ActivityType.Food)") {
                    targetSection = document.getElementById('food-section');
                } else if (selectedValue === "@((int)ActivityType.Electricity)") {
                    targetSection = document.getElementById('electricity-section');
                } else if (selectedValue === "@((int)ActivityType.Appliance)") {
                    targetSection = document.getElementById('appliance-section');
                } else if (selectedValue === "@((int)ActivityType.Waste)") {
                    targetSection = document.getElementById('waste-section');
                }

                if (targetSection) {
                    targetSection.style.display = 'block';
                    targetSection.querySelectorAll('input, select').forEach(input => input.disabled = false);
                }
            }

            selector.addEventListener('change', toggleSections);
            toggleSections(); 
        });
    </script>
}
