@model IEnumerable<EcoTrack.WebMvc.ViewModels.SuggestionViewModel>

@{
    ViewData["Title"] = ViewBag.Title;
}

<div class="d-flex justify-content-between align-items-center mb-4">
    <h1>@ViewData["Title"]</h1>
    <div>
        @if (ViewBag.ShowAll)
        {
            <a asp-action="Index" asp-route-showAll="false" class="btn btn-secondary">Show Unread Only</a>
        }
        else
        {
            <a asp-action="Index" asp-route-showAll="true" class="btn btn-primary">Show All Suggestions</a>
        }
    </div>
</div>

@if (!Model.Any())
{
    <div class="alert alert-info" role="alert">
        You have no new suggestions. Keep logging activities to get personalized tips!
    </div>
}
else
{
    <div class="list-group">
        @foreach (var suggestion in Model)
        {
            <div class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                <div>
                    <h5 class="mb-1">@suggestion.Category</h5>
                    <p class="mb-1">@suggestion.Description</p>
                    <small class="text-muted">Potential Saving: @suggestion.SavingAmountDisplay | Received: @suggestion.DateIssuedDisplay</small>
                </div>
                
                @* Only show the "Mark as Read" button for unread suggestions *@
                @if (ViewBag.ShowAll == false)
                {
                    <form asp-action="MarkAsRead" method="post" class="ms-3">
                        <input type="hidden" name="suggestionId" value="@suggestion.SuggestionId" />
                        <button type="submit" class="btn btn-sm btn-outline-success">Mark as Read</button>
                    </form>
                }
            </div>
        }
    </div>
}